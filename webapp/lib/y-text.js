/**
 * yjs - A framework for real-time p2p shared editing on any data
 * @version v12.3.1
 * @link http://y-js.org
 * @license MIT
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.yText=e()}}(function(){return function e(t,n,r){function i(s,l){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){function r(e,t,n){if(e==t)return e?[[p,e]]:[];(n<0||e.length<n)&&(n=null);var r=l(e,t),o=e.substring(0,r);e=e.substring(r),t=t.substring(r),r=a(e,t);var s=e.substring(e.length-r);e=e.substring(0,e.length-r),t=t.substring(0,t.length-r);var u=i(e,t);return o&&u.unshift([p,o]),s&&u.push([p,s]),c(u),null!=n&&(u=h(u,n)),u}function i(e,t){var n;if(!e)return[[v,t]];if(!t)return[[d,e]];var i=e.length>t.length?e:t,s=e.length>t.length?t:e,l=i.indexOf(s);if(-1!=l)return n=[[v,i.substring(0,l)],[p,s],[v,i.substring(l+s.length)]],e.length>t.length&&(n[0][0]=n[2][0]=d),n;if(1==s.length)return[[d,e],[v,t]];var a=u(e,t);if(a){var c=a[0],f=a[1],h=a[2],g=a[3],b=a[4],y=r(c,h),m=r(f,g);return y.concat([[p,b]],m)}return o(e,t)}function o(e,t){for(var n=e.length,r=t.length,i=Math.ceil((n+r)/2),o=i,l=2*i,a=new Array(l),u=new Array(l),c=0;c<l;c++)a[c]=-1,u[c]=-1;a[o+1]=0,u[o+1]=0;for(var f=n-r,h=f%2!=0,g=0,p=0,b=0,y=0,m=0;m<i;m++){for(var x=-m+g;x<=m-p;x+=2){var _,w=o+x;_=x==-m||x!=m&&a[w-1]<a[w+1]?a[w+1]:a[w-1]+1;for(var M=_-x;_<n&&M<r&&e.charAt(_)==t.charAt(M);)_++,M++;if(a[w]=_,_>n)p+=2;else if(M>r)g+=2;else if(h){var k=o+f-x;if(k>=0&&k<l&&-1!=u[k]){var O=n-u[k];if(_>=O)return s(e,t,_,M)}}}for(var C=-m+b;C<=m-y;C+=2){var O,k=o+C;O=C==-m||C!=m&&u[k-1]<u[k+1]?u[k+1]:u[k-1]+1;for(var I=O-C;O<n&&I<r&&e.charAt(n-O-1)==t.charAt(r-I-1);)O++,I++;if(u[k]=O,O>n)y+=2;else if(I>r)b+=2;else if(!h){var w=o+f-C;if(w>=0&&w<l&&-1!=a[w]){var _=a[w],M=o+_-w;if(O=n-O,_>=O)return s(e,t,_,M)}}}}return[[d,e],[v,t]]}function s(e,t,n,i){var o=e.substring(0,n),s=t.substring(0,i),l=e.substring(n),a=t.substring(i),u=r(o,s),c=r(l,a);return u.concat(c)}function l(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function a(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function u(e,t){function n(e,t,n){for(var r,i,o,s,u=e.substring(n,n+Math.floor(e.length/4)),c=-1,f="";-1!=(c=t.indexOf(u,c+1));){var h=l(e.substring(n),t.substring(c)),g=a(e.substring(0,n),t.substring(0,c));f.length<g+h&&(f=t.substring(c-g,c)+t.substring(c,c+h),r=e.substring(0,n-g),i=e.substring(n+h),o=t.substring(0,c-g),s=t.substring(c+h))}return 2*f.length>=e.length?[r,i,o,s,f]:null}var r=e.length>t.length?e:t,i=e.length>t.length?t:e;if(r.length<4||2*i.length<r.length)return null;var o,s=n(r,i,Math.ceil(r.length/4)),u=n(r,i,Math.ceil(r.length/2));if(!s&&!u)return null;o=u?s&&s[4].length>u[4].length?s:u:s;var c,f,h,g;return e.length>t.length?(c=o[0],f=o[1],h=o[2],g=o[3]):(h=o[0],g=o[1],c=o[2],f=o[3]),[c,f,h,g,o[4]]}function c(e){e.push([p,""]);for(var t,n=0,r=0,i=0,o="",s="";n<e.length;)switch(e[n][0]){case v:i++,s+=e[n][1],n++;break;case d:r++,o+=e[n][1],n++;break;case p:r+i>1?(0!==r&&0!==i&&(t=l(s,o),0!==t&&(n-r-i>0&&e[n-r-i-1][0]==p?e[n-r-i-1][1]+=s.substring(0,t):(e.splice(0,0,[p,s.substring(0,t)]),n++),s=s.substring(t),o=o.substring(t)),0!==(t=a(s,o))&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),o=o.substring(0,o.length-t))),0===r?e.splice(n-i,r+i,[v,s]):0===i?e.splice(n-r,r+i,[d,o]):e.splice(n-r-i,r+i,[d,o],[v,s]),n=n-r-i+(r?1:0)+(i?1:0)+1):0!==n&&e[n-1][0]==p?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",s=""}""===e[e.length-1][1]&&e.pop();var u=!1;for(n=1;n<e.length-1;)e[n-1][0]==p&&e[n+1][0]==p&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),u=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),u=!0)),n++;u&&c(e)}function f(e,t){if(0===t)return[p,e];for(var n=0,r=0;r<e.length;r++){var i=e[r];if(i[0]===d||i[0]===p){var o=n+i[1].length;if(t===o)return[r+1,e];if(t<o){e=e.slice();var s=t-n,l=[i[0],i[1].slice(0,s)],a=[i[0],i[1].slice(s)];return e.splice(r,1,l,a),[r+1,e]}n=o}}throw new Error("cursor_pos is out of bounds!")}function h(e,t){var n=f(e,t),r=n[1],i=n[0],o=r[i],s=r[i+1];if(null==o)return e;if(o[0]!==p)return e;if(null!=s&&o[1]+s[1]===s[1]+o[1])return r.splice(i,2,s,o),g(r,i,2);if(null!=s&&0===s[1].indexOf(o[1])){r.splice(i,2,[s[0],o[1]],[0,o[1]]);var l=s[1].slice(o[1].length);return l.length>0&&r.splice(i+2,0,[s[0],l]),g(r,i,3)}return e}function g(e,t,n){for(var r=t+n-1;r>=0&&r>=t-1;r--)if(r+1<e.length){var i=e[r],o=e[r+1];i[0]===o[1]&&e.splice(r,2,[i[0],i[1]+o[1]])}return e}var d=-1,v=1,p=0,b=r;b.INSERT=v,b.DELETE=d,b.EQUAL=p,t.exports=b},{}],2:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){e.requestModules(["Array"]).then(function(){var t=function(e){function t(e,n,o){r(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));return s.textfields=[],s.aceInstances=[],s.codeMirrorInstances=[],s.monacoInstances=[],s}return o(t,e),l(t,[{key:"toString",value:function(){return this._content.map(function(e){return e.val}).join("")}},{key:"insert",value:function(e,n){for(var r=n.split(""),i=0;i<r.length;i++)/[\uD800-\uDFFF]/.test(r[i])&&(r[i]=r[i]+r[i+1],r[i+1]="",i++);a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insert",this).call(this,e,r)}},{key:"delete",value:function(e,n){if(null==n&&(n=1),"number"!=typeof n)throw new Error("length must be a number!");if("number"!=typeof e)throw new Error("pos must be a number!");if(e+n>this._content.length||e<0||n<0)throw new Error("The deletion range exceeds the range of the array!");if(0!==n)if(this._content.length>e+n&&""===this._content[e+n].val&&2===this._content[e+n-1].val.length){var r=this._content[e+n-1].val[0];a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this,e,n+1),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insert",this).call(this,e,[r])}else if(e>0&&""===this._content[e].val&&2===this._content[e-1].val.length){var i=this._content[e-1].val[1];a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this,e-1,n+1),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"insert",this).call(this,e-1,[i])}else a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this,e,n)}},{key:"unbindAll",value:function(){this.unbindTextareaAll(),this.unbindAceAll(),this.unbindCodeMirrorAll(),this.unbindMonacoAll()}},{key:"unbindMonaco",value:function(e){var t=this.monacoInstances.findIndex(function(t){return t.editor===e});if(t>=0){var n=this.monacoInstances[t];this.unobserve(n.yCallback),n.disposeBinding(),this.monacoInstances.splice(t,1)}}},{key:"unbindMonacoAll",value:function(){for(var e=this.monacoInstances.length-1;e>=0;e--)this.unbindMonaco(this.monacoInstances[e].editor)}},{key:"bindMonaco",value:function(e,t){function n(e){if(s){s=!1;try{e()}catch(e){throw s=!0,new Error(e)}s=!0}}function r(e){n(function(){for(var t=0,n=1;n<e.range.startLineNumber;t++)"\n"===o._content[t].val&&n++;var r=t+e.range.startColumn-1;e.rangeLength>0&&o.delete(r,e.rangeLength),o.insert(r,e.text)})}function i(t){n(function(){var n,r,i=e.model.getPositionAt(t.index);"insert"===t.type?(n=i,r=t.values.join("")):"delete"===t.type&&(n=e.model.modifyPosition(i,t.length),r="");var o={startLineNumber:i.lineNumber,startColumn:i.column,endLineNumber:n.lineNumber,endColumn:n.column},s={major:c.major,minor:c.minor++};e.executeEdits("Yjs",[{id:s,range:o,text:r,forceMoveMarkers:!0}])})}var o=this;t=t||{};var s=!0;e.setValue(this.toString());var l=e.onDidChangeModelContent(r).dispose;this.observe(i),this.monacoInstances.push({editor:e,yCallback:i,monacoCallback:r,disposeBinding:l})}},{key:"unbindCodeMirror",value:function(e){var t=this.codeMirrorInstances.findIndex(function(t){return t.editor===e});if(t>=0){var n=this.codeMirrorInstances[t];this.unobserve(n.yCallback),n.editor.off("changes",n.codeMirrorCallback),this.codeMirrorInstances.splice(t,1)}}},{key:"unbindCodeMirrorAll",value:function(){for(var e=this.codeMirrorInstances.length-1;e>=0;e--)this.unbindCodeMirror(this.codeMirrorInstances[e].editor)}},{key:"bindCodeMirror",value:function(e,t){function n(e){if(s){s=!1;try{e()}catch(e){throw s=!0,new Error(e)}s=!0}}function r(t,r){n(function(){for(var t=0;t<r.length;t++){var n=r[t],i=e.indexFromPos(n.from);if(n.removed.length>0){for(var s=0,l=0;l<n.removed.length;l++)s+=n.removed[l].length;s+=n.removed.length-1,o.delete(i,s)}o.insert(i,n.text.join("\n"))}})}function i(t){n(function(){var n=e.posFromIndex(t.index);if("insert"===t.type){var r=n;e.replaceRange(t.values.join(""),n,r)}else if("delete"===t.type){var i=e.posFromIndex(t.index+t.length);e.replaceRange("",n,i)}})}var o=this;t=t||{};var s=!0;e.setValue(this.toString()),e.on("changes",r),this.observe(i),this.codeMirrorInstances.push({editor:e,yCallback:i,codeMirrorCallback:r})}},{key:"unbindAce",value:function(e){var t=this.aceInstances.findIndex(function(t){return t.editor===e});if(t>=0){var n=this.aceInstances[t];this.unobserve(n.yCallback),n.editor.off("change",n.aceCallback),this.aceInstances.splice(t,1)}}},{key:"unbindAceAll",value:function(){for(var e=this.aceInstances.length-1;e>=0;e--)this.unbindAce(this.aceInstances[e].editor)}},{key:"bindAce",value:function(e,t){function n(e){if(s){s=!1;try{e()}catch(e){throw s=!0,new Error(e)}s=!0}}function r(t){n(function(){var n,r,i=e.getSession().getDocument();"insert"===t.action?(n=i.positionToIndex(t.start,0),o.insert(n,t.lines.join("\n"))):"remove"===t.action&&(n=i.positionToIndex(t.start,0),r=t.lines.join("\n").length,o.delete(n,r))})}function i(t){var r=e.getSession().getDocument();n(function(){if("insert"===t.type){var e=r.indexToPosition(t.index,0);r.insert(e,t.values.join(""))}else if("delete"===t.type){var n=r.indexToPosition(t.index,0),i=r.indexToPosition(t.index+t.length,0),o=new u(n.row,n.column,i.row,i.column);r.remove(o)}})}var o=this;t=t||{};var s=!0;e.setValue(this.toString()),e.on("change",r),e.selection.clearSelection();var l;l="undefined"!=typeof ace&&null==t.aceClass?ace:t.aceClass;var a=t.aceRequire||l.require,u=a("ace/range").Range;this.observe(i),this.aceInstances.push({editor:e,yCallback:i,aceCallback:r})}},{key:"bind",value:function(){var e=arguments[0];e instanceof Element?this.bindTextarea.apply(this,arguments):null!=e&&null!=e.session&&null!=e.getSession&&null!=e.setValue?this.bindAce.apply(this,arguments):null!=e&&null!=e.posFromIndex&&null!=e.replaceRange?this.bindCodeMirror.apply(this,arguments):null!=e&&null!=e.onDidChangeModelContent?this.bindMonaco.apply(this,arguments):console.error("Cannot bind, unsupported editor!")}},{key:"unbindTextarea",value:function(e){var t=this.textfields.findIndex(function(t){return t.editor===e});if(t>=0){var n=this.textfields[t];this.unobserve(n.yCallback);n.editor.removeEventListener("input",n.eventListener),this.textfields.splice(t,1)}}},{key:"unbindTextareaAll",value:function(){for(var e=this.textfields.length-1;e>=0;e--)this.unbindTextarea(this.textfields[e].editor)}},{key:"bindTextarea",value:function(e,t){function n(e){if(o){o=!1;try{e()}catch(e){throw o=!0,new Error(e)}o=!0}}function r(e){n(function(){var t,n;if("insert"===e.type){t=e.index,n=function(e){return e<=t?e:e+=1};var r=l(n);a(r)}else"delete"===e.type&&(t=e.index,n=function(e){return e<t?e:e-=1},r=l(n),a(r))})}t=t||window,null==t.getSelection&&(t=window);for(var i=0;i<this.textfields.length;i++)if(this.textfields[i].editor===e)return;var o=!0,s=this;e.value=this.toString();var l,a,c,f;null!=e.selectionStart&&null!=e.setSelectionRange?(l=function(t){var n=e.selectionStart,r=e.selectionEnd;return null!=t&&(n=t(n),r=t(r)),{left:n,right:r}},a=function(t){c(s.toString()),e.setSelectionRange(t.left,t.right)},c=function(t){e.value=t},f=function(){return e.value}):(l=function(n){var r={},i=t.getSelection(),o=e.textContent.length;r.left=Math.min(i.anchorOffset,o),r.right=Math.min(i.focusOffset,o),null!=n&&(r.left=n(r.left),r.right=n(r.right));var s=i.focusNode;return s===e||s===e.childNodes[0]?r.isReal=!0:r.isReal=!1,r},a=function(n){c(s.toString());var r=e.childNodes[0];if(n.isReal&&null!=r){n.left<0&&(n.left=0),n.right=Math.max(n.left,n.right),n.right>r.length&&(n.right=r.length),n.left=Math.min(n.left,n.right);var i=document.createRange();i.setStart(r,n.left),i.setEnd(r,n.right);var o=t.getSelection();o.removeAllRanges(),o.addRange(i)}},c=function(t){e.innerText=t},f=function(){return e.innerText}),c(this.toString()),this.observe(r);var h=function(){n(function(){for(var e=l(function(e){return e}),t=s.toString(),n=f(),r=u(t,n,e.left),i=0,o=0;o<r.length;o++){var a=r[o];0===a[0]?i+=a[1].length:-1===a[0]?s.delete(i,a[1].length):(s.insert(i,a[1]),i+=a[1].length)}})};e.addEventListener("input",h),this.textfields.push({editor:e,yCallback:r,eventListener:h})}},{key:"_destroy",value:function(){this.unbindAll(),this.textfields=null,this.aceInstances=null,a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_destroy",this).call(this)}}]),t}(e.Array.typeDefinition.class);e.extend("Text",new e.utils.CustomTypeDefinition({name:"Text",class:t,struct:"List",initType:regeneratorRuntime.mark(function n(r,i){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=[],n.delegateYield(e.Struct.List.map.call(this,i,function(e){if(e.hasOwnProperty("opContent"))throw new Error("Text must not contain types!");e.content.forEach(function(t,n){o.push({id:[e.id[0],e.id[1]+n],val:e.content[n]})})}),"t0",2);case 2:return n.abrupt("return",new t(r,i.id,o));case 3:case"end":return n.stop()}},n,this)}),createType:function(e,n){return new t(e,n.id,[])}}))})}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},u=e("fast-diff"),c={major:0,minor:0};t.exports=s,"undefined"!=typeof Y&&s(Y)},{"fast-diff":1}]},{},[2])(2)});
//# sourceMappingURL=y-text.js.map
